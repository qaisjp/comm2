<div *ngIf="resource$ | async as resource">
  <h1>
    {{ resource.title }} ({{ resource.name }})
    <button [disabled]="!downloadable">Download</button>
  </h1>
  <ul>
    <li>Rating: NONE</li>
    <li>Authors:
      <ng-container *ngFor="let author of resource.authors; let last = last;">
        <a [routerLink]="['/u', author.username]">{{ author.username }}</a>
        <ng-container *ngIf="!last">, </ng-container>
      </ng-container>
    </li>
    <li>Description: {{ resource.description }}</li>
    <li>Last updated: {{ resource.updated_at | amTimeAgo }}</li>
    <li>Created at: {{ resource.created_at | amTimeAgo }}</li>
  </ul>

  <div>
    <strong>Version History</strong>
    <ng-template #packagesLoading>
      <div>Loading...</div>
    </ng-template>
    <table *ngIf="packages$ | async as packages; else packagesLoading" width="100%">
      <thead>
        <tr>
          <th>Version</th>
          <th>Publish Date</th>
          <th>Changes</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let pkg of packages">
          <td>{{ pkg.version }} <ng-template [ngIf]="pkg.draft">(draft)</ng-template></td>
          <td>{{ (pkg.draft ? pkg.updated_at : pkg.created_at) | amDateFormat: 'YYYY-MM-DD HH:mm' }}</td>
          <td>{{ pkg.description }}</td>
          <td>Download</td>
          <td>Contents</td>
          <td>Edit</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
